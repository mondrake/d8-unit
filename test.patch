diff --git a/composer.json b/composer.json
index 6702aeb10b..7bd255c547 100644
--- a/composer.json
+++ b/composer.json
@@ -28,6 +28,7 @@
         "phpspec/prophecy-phpunit": "^2",
         "phpstan/extension-installer": "^1.1",
         "phpstan/phpstan": "^1.10.1",
+        "phpstan/phpstan-phpunit": "^1.3.11",
         "phpunit/phpunit": "^9.5",
         "symfony/browser-kit": "^6.2",
         "symfony/css-selector": "^6.2",
diff --git a/composer.lock b/composer.lock
index 142674b58c..0bd8b8a5bd 100644
--- a/composer.lock
+++ b/composer.lock
@@ -4,7 +4,7 @@
         "Read more about it at https://getcomposer.org/doc/01-basic-usage.md#installing-dependencies",
         "This file is @generated automatically"
     ],
-    "content-hash": "4bd73d17c0466e563e03f3b00b30009e",
+    "content-hash": "e2a1cb0d156a2efb1cc295f77cc354af",
     "packages": [
         {
             "name": "asm89/stack-cors",
@@ -6166,6 +6166,58 @@
             ],
             "time": "2023-02-23T14:36:46+00:00"
         },
+        {
+            "name": "phpstan/phpstan-phpunit",
+            "version": "1.3.11",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/phpstan/phpstan-phpunit.git",
+                "reference": "9e1b9de6d260461f6e99b6a8f2dbb0bbb98b579c"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/phpstan/phpstan-phpunit/zipball/9e1b9de6d260461f6e99b6a8f2dbb0bbb98b579c",
+                "reference": "9e1b9de6d260461f6e99b6a8f2dbb0bbb98b579c",
+                "shasum": ""
+            },
+            "require": {
+                "php": "^7.2 || ^8.0",
+                "phpstan/phpstan": "^1.10"
+            },
+            "conflict": {
+                "phpunit/phpunit": "<7.0"
+            },
+            "require-dev": {
+                "nikic/php-parser": "^4.13.0",
+                "php-parallel-lint/php-parallel-lint": "^1.2",
+                "phpstan/phpstan-strict-rules": "^1.0",
+                "phpunit/phpunit": "^9.5"
+            },
+            "type": "phpstan-extension",
+            "extra": {
+                "phpstan": {
+                    "includes": [
+                        "extension.neon",
+                        "rules.neon"
+                    ]
+                }
+            },
+            "autoload": {
+                "psr-4": {
+                    "PHPStan\\": "src/"
+                }
+            },
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "MIT"
+            ],
+            "description": "PHPUnit extensions and rules for PHPStan",
+            "support": {
+                "issues": "https://github.com/phpstan/phpstan-phpunit/issues",
+                "source": "https://github.com/phpstan/phpstan-phpunit/tree/1.3.11"
+            },
+            "time": "2023-03-25T19:42:13+00:00"
+        },
         {
             "name": "phpunit/php-code-coverage",
             "version": "9.2.24",
diff --git a/composer/Metapackage/DevDependencies/composer.json b/composer/Metapackage/DevDependencies/composer.json
index 3db5544de5..8647a1f999 100644
--- a/composer/Metapackage/DevDependencies/composer.json
+++ b/composer/Metapackage/DevDependencies/composer.json
@@ -20,6 +20,7 @@
         "phpspec/prophecy-phpunit": "^2",
         "phpstan/extension-installer": "^1.1",
         "phpstan/phpstan": "^1.10.1",
+        "phpstan/phpstan-phpunit": "^1.3.11",
         "phpunit/phpunit": "^9.5",
         "symfony/browser-kit": "^6.2",
         "symfony/css-selector": "^6.2",
diff --git a/composer/Metapackage/PinnedDevDependencies/composer.json b/composer/Metapackage/PinnedDevDependencies/composer.json
index 6d88a064ba..de402a37f6 100644
--- a/composer/Metapackage/PinnedDevDependencies/composer.json
+++ b/composer/Metapackage/PinnedDevDependencies/composer.json
@@ -38,6 +38,7 @@
         "phpstan/extension-installer": "1.2.0",
         "phpstan/phpdoc-parser": "1.15.3",
         "phpstan/phpstan": "1.10.2",
+        "phpstan/phpstan-phpunit": "1.3.11",
         "phpunit/php-code-coverage": "9.2.24",
         "phpunit/php-file-iterator": "3.0.6",
         "phpunit/php-invoker": "3.1.1",
diff --git a/core/phpstan.neon.dist b/core/phpstan.neon.dist
index ded8039518..54686cf038 100644
--- a/core/phpstan.neon.dist
+++ b/core/phpstan.neon.dist
@@ -37,3 +37,8 @@ parameters:
     - "#^Missing cache backend declaration for performance.#"
     - "#cache tag might be unclear and does not contain the cache key in it.#"
     - "#^Class .* extends @internal class#"
+
+    # phpstan/phpstan-phpunit does not support methods added to mocks if they
+    # are not defined in an interface, which is a rather opinionated approach.
+    # @see https://github.com/phpstan/phpstan-phpunit/issues/87
+    - "#^Trying to mock an undefined method .* on class #"
