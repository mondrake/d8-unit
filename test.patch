diff --git a/core/lib/Drupal/Core/Database/StatementWrapper.php b/core/lib/Drupal/Core/Database/StatementWrapper.php
index 8a3bc208c5..37e1c129b4 100644
--- a/core/lib/Drupal/Core/Database/StatementWrapper.php
+++ b/core/lib/Drupal/Core/Database/StatementWrapper.php
@@ -7,7 +7,7 @@
 /**
  * Implementation of StatementInterface encapsulating PDOStatement.
  */
-class StatementWrapper implements \IteratorAggregate, StatementInterface {
+class StatementWrapper implements \Iterator, StatementInterface {
 
   /**
    * The Drupal database connection object.
@@ -32,6 +32,20 @@ class StatementWrapper implements \IteratorAggregate, StatementInterface {
    */
   protected $rowCountEnabled = FALSE;
 
+  /**
+   * The current row, retrieved in the current fetch format.
+   *
+   * @var mixed
+   */
+  protected mixed $currentRow = NULL;
+
+  /**
+   * The key of the current row.
+   *
+   * @var int|null
+   */
+  protected ?int $currentKey = NULL;
+
   /**
    * Constructs a StatementWrapper object.
    *
@@ -76,6 +90,9 @@ public function getConnectionTarget(): string {
    * {@inheritdoc}
    */
   public function execute($args = [], $options = []) {
+    $this->currentRow = NULL;
+    $this->currentKey = NULL;
+
     if (isset($options['fetch'])) {
       if (is_string($options['fetch'])) {
         // \PDO::FETCH_PROPS_LATE tells __construct() to run before properties
@@ -154,15 +171,13 @@ public function fetchAllKeyed($key_index = 0, $value_index = 1) {
    * {@inheritdoc}
    */
   public function fetchField($index = 0) {
-    // Call \PDOStatement::fetchColumn to fetch the field.
-    return $this->clientStatement->fetchColumn($index);
+    return $this->fetch(\PDO::FETCH_NUM)[$index] ?? FALSE;
   }
 
   /**
    * {@inheritdoc}
    */
   public function fetchAssoc() {
-    // Call \PDOStatement::fetch to fetch the row.
     return $this->fetch(\PDO::FETCH_ASSOC);
   }
 
@@ -171,9 +186,19 @@ public function fetchAssoc() {
    */
   public function fetchObject(string $class_name = NULL, array $constructor_arguments = NULL) {
     if ($class_name) {
-      return $this->clientStatement->fetchObject($class_name, $constructor_arguments);
+      $this->currentRow = $this->clientStatement->fetchObject($class_name, $constructor_arguments);
+    }
+    $this->currentRow = $this->clientStatement->fetchObject();
+
+    if ($this->currentRow) {
+      $this->currentKey = $this->currentKey === NULL ? 0 : $this->currentKey++;
     }
-    return $this->clientStatement->fetchObject();
+    else {
+      $this->currentRow = NULL;
+      $this->currentKey = NULL;
+    }
+
+    return $this->currentRow;
   }
 
   /**
@@ -215,27 +240,44 @@ public function setFetchMode($mode, $a1 = NULL, $a2 = []) {
   public function fetch($mode = NULL, $cursor_orientation = NULL, $cursor_offset = NULL) {
     // Call \PDOStatement::fetchAll to fetch all rows.
     // \PDOStatement is picky about the number of arguments in some cases so we
-    // need to be pass the exact number of arguments we where given.
+    // need to pass the exact number of arguments we were given.
     switch (func_num_args()) {
       case 0:
-        return $this->clientStatement->fetch();
+        $this->currentRow = $this->clientStatement->fetch();
+        break;
 
       case 1:
-        return $this->clientStatement->fetch($mode);
+        $this->currentRow = $this->clientStatement->fetch($mode);
+        break;
 
       case 2:
-        return $this->clientStatement->fetch($mode, $cursor_orientation);
+        $this->currentRow = $this->clientStatement->fetch($mode, $cursor_orientation);
+        break;
 
       case 3:
       default:
-        return $this->clientStatement->fetch($mode, $cursor_orientation, $cursor_offset);
+        $this->currentRow = $this->clientStatement->fetch($mode, $cursor_orientation, $cursor_offset);
+        break;
+    }
+
+    if ($this->currentRow) {
+      $this->currentKey = $this->currentKey === NULL ? 0 : $this->currentKey++;
+    }
+    else {
+      $this->currentRow = NULL;
+      $this->currentKey = NULL;
     }
+
+    return $this->currentRow;
   }
 
   /**
    * {@inheritdoc}
    */
   public function fetchAll($mode = NULL, $column_index = NULL, $constructor_arguments = NULL) {
+    $this->currentRow = NULL;
+    $this->currentKey = NULL;
+
     // Call \PDOStatement::fetchAll to fetch all rows.
     // \PDOStatement is picky about the number of arguments in some cases so we
     // need to be pass the exact number of arguments we where given.
@@ -258,9 +300,41 @@ public function fetchAll($mode = NULL, $column_index = NULL, $constructor_argume
   /**
    * {@inheritdoc}
    */
-  #[\ReturnTypeWillChange]
-  public function getIterator() {
-    return new \ArrayIterator($this->fetchAll());
+  public function current(): mixed {
+dump(['current', $this->currentKey, $this->currentRow]);
+    return $this->currentRow;
+  }
+
+  /**
+   * {@inheritdoc}
+   */
+  public function key(): mixed {
+dump(['key', $this->currentKey, $this->currentRow]);
+    return $this->currentKey;
+  }
+
+  /**
+   * {@inheritdoc}
+   */
+  public function rewind(): void {
+dump(['rewind']);
+    // Nothing to do: our DatabaseStatement can't be rewound.
+  }
+
+  /**
+   * {@inheritdoc}
+   */
+  public function next(): void {
+    $this->fetch();
+dump(['next', $this->currentKey, $this->currentRow]);
+  }
+
+  /**
+   * {@inheritdoc}
+   */
+  public function valid(): bool {
+dump(['valid', $this->currentKey, $this->currentRow]);
+    return (bool) $this->currentRow;
   }
 
 }
